<!DOCTYPE html>
<html>

<head>
	<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1">
	<meta charset="UTF-8">
	<title></title>
	<link rel="stylesheet" href="css/fonts/iconfont.css">
	<link rel="stylesheet" href="css/iuapmobile.um.css">
	<!-- <link rel="stylesheet" href="css/swiper-3.4.2.min.css"> -->
	<link rel="stylesheet" href="css/index.css">
	<script src="js/summer.js"></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/Frameworks/iuapmobile.frameworks.ui.js"></script>
	<script src="js/font.js" charset="utf-8"></script>
	<script src="js/common.js" charset="utf-8"></script>
	<script src="js/idangerous.swiper-2.0.min.js" charset="utf-8"></script>
	<script src="js/common.js"></script>
	<script src="js/vue.js"></script>
	<!-- <script src="js/index.js" ></script> -->
</head>

<body>
	<div id="win" class="um-frame">
		<div id="content" class="um-content p15">
			<div class="container">
				<div id='banner-inner' class='swiper-container'>
					<div class='swiper-wrapper'>
						<div class="swiper-slide">
							<img src="img/banner1.jpg" alt="" />
						</div>
						<div class="swiper-slide">
							<img src="img/banner2.jpg" alt="" />
						</div>
						<div class="swiper-slide">
							<img src="img/banner3.jpg" alt="" />
						</div>
						<div class="swiper-slide">
							<img src="img/banner4.jpg" alt="" />
						</div>
					</div>
				</div>
			</div>
			<h2 class="xmgl">
				<div>
					<span></span>
					<i>业务管理</i>
				</div>
			</h2>
			<div class="xmgl_con">
				<ul class="xmgl_list clearfix">
					<!-- <li onclick="mission()" class="">
						<dl>
							<dt class="iconfont icon-submit" style="color:#c79644"></dt>
							<dd>审批管理</dd>
						</dl>
						<span class="missionNum" v-show='missionNum>0'>{{missionNum}}</span>
					</li> -->
					<li onclick="openFastReport()">
						<dl>
							<dt class="iconfont icon-nav_house" style="color:#88d27c"></dt>
							<dd>业务申请</dd>
						</dl>
					</li>
					<li onclick="openPayList()">
						<dl>
							<dt class="iconfont icon-qiandao" style="color:#c79644"></dt>
							<dd>付款申请</dd>
						</dl>
					</li>
					<li onclick="openQuotedPrice()">
						<dl>
							<dt class="iconfont icon-vote" style="color:#c79644"></dt>
							<dd>报价测算器</dd>
						</dl>
					</li>
					<li onclick="openPayTab()">
						<dl>
							<dt class="iconfont icon-search1" style="color:#88d27c"></dt>
							<dd>支付表查询</dd>
						</dl>
					</li>
					<li onclick="openRiskTracking()">
						<dl>
							<dt class="iconfont icon-leave_leave" style="color:#403b3a"></dt>
							<dd>逾期罚息</dd>
						</dl>
					</li>
					<li onclick="openStatement()">
						<dl>
							<dt class="iconfont icon-send_blog" style="color:#c79644"></dt>
							<dd>对账还款</dd>
						</dl>
					</li>
				</ul>
			</div>
			<h2 class="crm">
				<div>
					<span></span>
					<i>CRM</i>
				</div>
			</h2>
			<div class="crm_con">
				<ul class="crm_list clearfix">
					<li onclick="openNewCustom()">
						<dl>
							<dt class="iconfont icon-people-l" style="color:#88d27c"></dt>
							<dd>客户</dd>
						</dl>
					</li>
					<li onclick="openOpportunity()">
                        <dl>
                            <dt class="iconfont icon-house" style="color:#c79644"></dt>
                            <dd>商机</dd>
                        </dl>
                    </li>
                    <li onclick="openBriefing()">
                        <dl>
                            <dt class="iconfont icon-version" style="color:#403b3a"></dt>
                            <dd>月度计划</dd>
                        </dl>
					</li>
					<!--li onclick="update1()">
                        <dl>
                            <dt class="iconfont icon-version" style="color:#403b3a"></dt>
                            <dd>月度计划</dd>
                        </dl>
                    </li-->
				</ul>
			</div>
		</div>
	</div>
	<script>

		summerready = function () {
			/* if (isLogin()) {
				getMissionData(); //获取代办任务个数
			}
			summer.setRefreshHeaderInfo({
				visible: true,
				loadingImg: 'img/refresh.png',
				bgColor: '#ffffff',
				textColor: '#aaaaaa',
				textDown: '下拉刷新...',
				textUp: '松开刷新...',
				showTime: true
			}, function(ret, err) {
				//通常在这里从服务器加载数据，t
				getMissionData();
			}); */
			// 关闭启动图
			setTimeout(function () {
				summer.hideLaunch();
			}, 500);
			var mySwiper = new Swiper('.swiper-container', {
				autoplay: 5000,
				loop: true
			});
			update();
		}

		/* function getMissionData() {
			fistPage.getMissionData();
		} */
		function update1() {
		summer.openWin({
				id: 'login',
				url: 'html/mine/index.html',
				isKeep: true,
				create: false,
				type: 'actionBar',
				actionBar: {
					title: "登录",
					titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
					backgroundColor: "#039be5",
					leftItem: {
						image: "img/back.png",
						method: "", //返回按钮自定义事件
						text: "返回",
						textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
					}
				}
		}); }

		//测试调试
		function update() {
		
					var appVersion = JSON.parse(summer.getAppVersion()).versionName;
					var versionType = 0;
					var platform = $summer.os;
						if(platform == "android"){
							// 执行android特殊代码
							versionType = "1";
						} else if(platform == "ios"){
							// 执行ios特殊代码
							versionType = "2";
						} else if(platform == "pc"){
							// 执行pc特殊代码
						}
                    ajaxRequest({
                        type: 'post',
                        url: '/appsys/getNewapp',
                        param: {
                            "version": appVersion,
                            "mobileType": versionType
                        }
                    }, function(res) {
                        if (res.data.flag == 1) {
							console.log("res.data.datas",res.data.datas)
                            var NEW_VERSION = res.data.datas.NEW_VERSION;
                            if (res.data.datas.upFlag == 1) {
                                UM.confirm({
                                    title: '检测到新版本，是否升级？',
                                    btnText: ["取消", "确定"],
                                    overlay: true,
                                    ok: function () {
										summer.openWebView({
                                            url : res.data.datas.NEWVERSION
                                        });
                                        // summer.upgradeApp({
                                        //     url: res.data.datas.NEWVERSION
                                        // },function (ret) {
                                        //     if (ret.state == 1 || ret == "OK") {
                                        //         summer.toast({
                                        //             msg : '升级成功'
                                        //         });
                                        //     }
                                        // },function (err) {
                                        //     summer.toast({
                                        //         msg : '升级失败'
                                        //     });
                                        // })
                                    }
                                });
                            }
                        }
                    }, function(err) {
                        console.log(err);
                    });
                
		} 
		var fistPage = new Vue({
			el: '#win',
			data: {
				missionNum: ''
			},
			methods: {
				getMissionData:function () {
					var self = this;
					ajaxRequest({
						type: 'post',
						url: 'appservice/bpmtask/myTaskCount',
						param: {}
					}, function (res) {
						summer.hideProgress();
						if (res.data.flag == 1) {
							self.missionNum = parseInt(res.data.datas.count);
							console.log(res);
						}
					}, function (err) {
						alert(err);
						console.log(err);
						summer.hideProgress();
					});
					this.$nextTick(function () {
						summer.refreshHeaderLoadDone() //加载完成后调用方法恢复组件到默认状态
						summer.refreshFooterLoadDone(); //加载完成后调用方法恢复组件到默认状态
					})
				}
			}
		
		});
		// 判断是否已登陆
		function isLogin() {
			if (summer.getStorage("userinfo")) {
				if (summer.getStorage("userinfo").EMPLOYEE_ID) {
					return true;
				} else {
					return false;
				}
			} else {
				return false;
			}
		}

		// 空方法
		function none() {
			console.log(1);
		};
		// 跳回登录页
		function toLog() {
			summer.setStorage("userinfo", {});
			summer.toast({
				"msg": "请先登录"
			});
			summer.openWin({
				id: 'login',
				url: 'login.html',
				isKeep: true,
				create: false,
				type: 'actionBar',
				actionBar: {
					title: "登录",
					titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
					backgroundColor: "#039be5",
					leftItem: {
						image: "img/back.png",
						method: "", //返回按钮自定义事件
						text: "返回",
						textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
					}
				}
			});
		};
		// 支付表查询
		function openPayTab() {
			if (isLogin()) {
				summer.openWin({
					id: 'payTable',
					url: 'html/payTableQuery/payTableList.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "支付表查询",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						}
					}
				})
			} else {
				toLog();
			}
		}
		// 风险跟踪
		function openRiskTracking() {
			if (isLogin()) {
				summer.openWin({
					id: 'riskTracking',
					url: 'html/riskTracking/index.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "风险跟踪",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						}
					}
				})
			} else {
				toLog();
			}
		}
		// 对账单
		function openStatement() {
			if (isLogin()) {
				summer.openWin({
					id: 'statement',
					url: 'html/statement/statementList.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "客户对账单",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						}
					}
				})
			} else {
				toLog();
			}
		}
		// 销售线索
		function openLeads() {
			if (isLogin()) {
				summer.openWin({
					id: 'leadsList',
					url: 'html/salesLeads/leadsList.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "销售线索",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						},
						rightItems: [{
							type: "text",
							text: "新建",
							textColor: "#ffffff",
							method: "addLeads()"
						}]
					}
				})
			} else {
				toLog();
			}
		}
		// 月度计划
		function openBriefing() {
			if (isLogin()) {
				summer.openWin({
					id: 'monthPlay',
					url: 'html/monthPlay/monthPlay.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "月度计划",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						}
					}
				})
			} else {
				toLog();
			}
		}

		function openQuotedPrice() {
			if (isLogin()) {
				summer.openWin({
					id: 'quotedPriceDetailHome',
					url: 'html/priceCalculation/quotedPriceDetail_home.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "报价测算",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						}
					}
				})
			} else {
				toLog();
			}
		}

		function openAddCar() {
			if (isLogin()) {
				summer.openWin({
					id: 'setProject',
					url: 'html/fastReport/setProject.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "快捷报单",
						titleColor: "#000000", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#000000" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						}
					}
				})
			} else {
				toLog();
			}
		}
		// 代办任务
		function mission() {
			if (isLogin()) {
				summer.openWin({
					id: 'missionIndex',
					url: 'html/mission/index.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "审批管理",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						}
					}
				});
			} else {
				toLog();
			}
		};

		function openFastReport() {
			if (isLogin()) {
				summer.openWin({
					id: 'programSelect',
					url: 'html/fastReport/programSelect.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "业务查询",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						},
						rightItems: [{
							type: "text",
							text: "新建",
							textColor: "#ffffff",
							method: "newCustom()"
						}]
					}
				});
			} else {
				toLog();
			}
		}
		// 付款列表
		function openPayList() {
			if (isLogin()) {
				summer.openWin({
					id: 'payList',
					url: 'html/repayApply/payList/index.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "付款申请",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						}
					}
				});
			} else {
				toLog();
			}
		}
		// 商机
		function openOpportunity() {
			if (isLogin()) {
				summer.openWin({
					id: 'opportunityIndex',
					url: 'html/opportunity/index.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "商机",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						},
						rightItems: [{
							type: "text",
							text: "新建",
							textColor: "#ffffff",
							method: "opportunityIndex.createOpp()"
						}]
					}
				});
			} else {
				toLog();
			}
		};
		// 我的
		function showUserInfo() {
			summer.openWin({
				id: 'mine',
				url: 'html/mine/index.html',
				create: false,
				type: 'actionBar',
				actionBar: {
					title: "我的资料",
					titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
					backgroundColor: "#039be5",
					leftItem: {
						image: "img/back.png",
						method: "", //返回按钮自定义事件
						text: "返回",
						textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
					}
				}
			});
		}
		// 打开客户页面
		function openNewCustom() {
			if (isLogin()) {
				summer.openWin({
					id: 'newCustom',
					url: 'html/fastReport/newCustom.html',
					create: false,
					type: 'actionBar',
					actionBar: {
						title: "客户列表",
						titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
						backgroundColor: "#039be5",
						leftItem: {
							image: "img/back.png",
							method: "", //返回按钮自定义事件
							text: "返回",
							textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
						},
						rightItems: [{
							type: "text",
							text: "添加",
							textColor: "#ffffff",
							method: "newCreateCustom()"
						}]
					},
					pageParam: {
						pageSource: "index"
					}
				});
			} else {
				toLog();
			}
		};

		// 敬请期待
		function unfinished() {
			summer.toast({
				"msg": "敬请期待"
			});
		};

		//Android返回键监听
		var turn = 0;

		function keyBack() {
			turn++;
			if (turn == 2) {
				clearInterval(intervalID);
				summer.exitApp()
			} else {
				summer.toast({
					"msg": "再按一次退出"
				});
			}
			var intervalID = setInterval(function () {
				clearInterval(intervalID);
				turn = 0;
			}, 2000);
		};
	</script>
</body>

</html>
